{% extends "base.html" %}

{% block title %}
    <title>Home</title>
{% endblock %}

{% block content %}
	<div class="container mt-5">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h1 class="mb-0">TODO List</h1>
			<a href="{% url 'todo-app:create-task' %}" class="btn btn-primary">Add Task</a>
		</div>
			{% for task in tasks %}
				<li class="list-group-item d-flex justify-content-between align-items-center">
					<div>
						<strong>{{ task.content }}</strong>
						<br>
						<small class="text-muted">{{ task.created_at }}</small>
						{% if task.deadline %}
							<span class="badge bg-secondary">Deadline: {{ task.deadline }}</span>
						{% endif %}
						<br>
						<small>Tags: 
							{% for tag in task.tags.all %}
								<span class="badge bg-info">{{ tag.name }}</span>{% if not forloop.last %} {% endif %}
							{% endfor %}
						</small>
					</div>
					<div>
						<a href="{% url 'todo-app:update-task' task.id %}" class="btn btn-warning btn-sm me-1">Update</a>
						<a href="{% url 'todo-app:delete-task' task.id %}" class="btn btn-danger btn-sm me-1">Delete</a>
						<form method="post" action="{% url 'todo-app:home' %}" class="d-inline">
							{% csrf_token %}
							<input type="hidden" name="task_id" value="{{ task.id }}">
							{% if task.done %}
								<button type="submit" class="btn btn-secondary btn-sm">Undo</button>
							{% else %}
								<button type="submit" class="btn btn-success btn-sm">Complete</button>
							{% endif %}
						</form>
					</div>
				</li>
			{% endfor %}
		</ul>
	</div>
{% endblock %}
